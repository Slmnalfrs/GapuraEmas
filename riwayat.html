<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Riwayat - GAPURA EMAS</title>

    <link rel="stylesheet" href="css/global.css" />
    <link rel="stylesheet" href="css/riwayat.css" />
    <link rel="stylesheet" href="css/fab.css" />
    <script src="js/accessibility.js" defer></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>

  <body>
    <header class="navbar">
      <div class="logo">
        <img
          src="assets/gapura.png"
          alt="Logo Gapura Emas"
          class="logo-image"
        />
        <h1>GAPURA<span class="orange">EMAS</span></h1>
      </div>
      <nav>
        <a href="index.html">Beranda</a>
        <span class="nav-separator">|</span>
        <a href="personalisasi.html">Personalisasi</a>
        <span class="nav-separator">|</span>
        <a href="keamanan.html">Keamanan</a>
        <span class="nav-separator">|</span>
        <a href="riwayat.html" class="active">Riwayat</a>
      </nav>
      <div class="user-info">
        <i class="fas fa-bell notification-icon"></i>
        <div class="user-details">
          <span>Nama Pengguna</span>
          <p class="role">Role Pengguna</p>
        </div>
        <i class="fas fa-user-circle user-icon" id="user-icon-btn"></i>
        <div class="profile-dropdown" id="profile-dropdown">
          <div class="profile-dropdown-header">
            <button class="profile-close-btn" id="profile-close-btn">
              &times;
            </button>
          </div>
          <div class="profile-dropdown-body">
            <a href="#" class="btn btn-danger">
              <i class="fas fa-sign-out-alt"></i>
              <span>Logout</span>
            </a>
          </div>
        </div>
      </div>
    </header>

    <div class="notification-panel" id="notification-panel">
      <div class="notification-header">
        <h2>Notifikasi</h2>
        <button class="notification-close-btn" id="notification-close-btn">
          &times;
        </button>
      </div>
      <div class="notification-list">
        <a href="#" class="notification-item unread">
          <span class="notification-dot"></span>
          <p class="notification-text">Akun anda terblokir</p>
        </a>
        <a href="#" class="notification-item unread">
          <span class="notification-dot"></span>
          <p class="notification-text">
            Anda mendapatkan izin akses masuk Sepakat Kabupaten Pasuruan
          </p>
        </a>
        <a href="#" class="notification-item">
          <span class="notification-dot"></span>
          <p class="notification-text">Password anda berhasil diubah.</p>
        </a>
      </div>
      <div class="notification-footer">
        <button class="btn btn-secondary" id="clear-notifications">
          Bersihkan semua notifikasi
        </button>
      </div>
    </div>

    <main>
      <div class="container" style="padding-bottom: 30px">
        <h1 class="page-title">Riwayat (10 Terakhir)</h1>

        <div class="content-card">
          <div class="history-list">
            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; ... )</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; ... )</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>

            <div class="history-item">
              <div class="history-icon-wrapper">
                <span class="history-dot"></span>
                <span class="history-line"></span>
              </div>
              <div class="history-info">
                <h3>Login Sepakat Kabupaten Pasuruan</h3>
                <span class="history-meta"
                  >Selasa, 21 Oktober 2025 08:38:54</span
                >
                <span class="history-meta"
                  >UA:Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                  AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0
                  Safari/537.36</span
                >
                <span class="history-meta location">
                  <i class="fas fa-map-marker-alt"></i> Lokasi
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <div class="fab-container">
      <button
        class="fab"
        aria-haspopup="true"
        aria-expanded="false"
        aria-label="Aksesibilitas"
      >
        <i class="fas fa-universal-access"></i>
      </button>
    </div>

    <footer>
      <div class="container footer-content">
        <p class="copyright">
          COPYRIGHT © 2022–2025
          <a
            href="https://diskominfo.pasuruankab.go.id/"
            target="_blank"
            class="footer-link"
          >
            Diskominfo Kabupaten Pasuruan</a
          >
        </p>
        <p class="gov-text">Pemerintah Daerah Kabupaten Pasuruan</p>
      </div>
    </footer>

    <nav class="mobile-nav">
      <a href="index.html">
        <i class="fas fa-home"></i>
        <span>Beranda</span>
      </a>
      <a href="personalisasi.html">
        <i class="fas fa-user-cog"></i>
        <span>Personalisasi</span>
      </a>
      <a href="keamanan.html">
        <i class="fas fa-shield-alt"></i>
        <span>Keamanan</span>
      </a>
      <a href="riwayat.html" class="active">
        <i class="fas fa-history"></i>
        <span>Riwayat</span>
      </a>
    </nav>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // ============================================================
        // === LOGIKA DROPDOWN (NOTIFIKASI & PROFIL) ==================
        // ============================================================
        const notifIcon = document.querySelector(".notification-icon");
        const notifPanel = document.getElementById("notification-panel");
        const notifCloseBtn = document.getElementById("notification-close-btn");
        const notifList = document.querySelector(".notification-list");
        const clearBtn = document.getElementById("clear-notifications");

        const userIconBtn = document.getElementById("user-icon-btn");
        const profileDropdown = document.getElementById("profile-dropdown");
        const profileCloseBtn = document.getElementById("profile-close-btn");

        if (
          notifIcon &&
          notifPanel &&
          notifCloseBtn &&
          userIconBtn &&
          profileDropdown &&
          profileCloseBtn
        ) {
          // === 1. Klik Lonceng ===
          notifIcon.addEventListener("click", function (event) {
            event.stopPropagation();
            notifPanel.classList.toggle("active");
            profileDropdown.classList.remove("active"); // Tutup profil
          });

          // === 2. Klik Tombol 'X' Notifikasi ===
          notifCloseBtn.addEventListener("click", function () {
            notifPanel.classList.remove("active");
          });

          // === 3. Klik Ikon Profil ===
          userIconBtn.addEventListener("click", function (event) {
            event.stopPropagation();
            profileDropdown.classList.toggle("active");
            notifPanel.classList.remove("active"); // Tutup notifikasi
          });

          // === 4. Klik Tombol 'X' Profil ===
          profileCloseBtn.addEventListener("click", function () {
            profileDropdown.classList.remove("active");
          });

          // === 5. Klik di Luar Panel ===
          document.addEventListener("click", function (event) {
            if (
              notifPanel.classList.contains("active") &&
              !notifPanel.contains(event.target) &&
              !notifIcon.contains(event.target)
            ) {
              notifPanel.classList.remove("active");
            }
            if (
              profileDropdown.classList.contains("active") &&
              !profileDropdown.contains(event.target) &&
              !userIconBtn.contains(event.target)
            ) {
              profileDropdown.classList.remove("active");
            }
          });

          // === 6. Tutup Panel Saat Tekan Escape ===
          document.addEventListener("keydown", function (event) {
            if (event.key === "Escape") {
              notifPanel.classList.remove("active");
              profileDropdown.classList.remove("active");
            }
          });
        }

        // ============================================================
        // === SISTEM NOTIFIKASI (BARU DITAMBAHKAN) ===================
        // ============================================================

        /** Render daftar notifikasi dari localStorage */
        function renderNotifications() {
          const saved = JSON.parse(localStorage.getItem("notifikasiApp")) || [];
          notifList.innerHTML = "";

          if (saved.length === 0) {
            const empty = document.createElement("p");
            empty.style.padding = "15px 20px";
            empty.style.textAlign = "center";
            empty.style.color = "#777";
            empty.textContent = "Tidak ada notifikasi baru.";
            notifList.appendChild(empty);
            if (clearBtn) {
              clearBtn.disabled = true;
              clearBtn.textContent = "Tidak ada notifikasi";
            }
          } else {
            saved.forEach((n) => {
              const item = document.createElement("a");
              item.href = "#";
              item.className = "notification-item";
              item.innerHTML = `
            <span class="notification-dot"></span>
            <p class="notification-text">${n.text}</p>
          `;
              notifList.appendChild(item);
            });
            if (clearBtn) {
              clearBtn.disabled = false;
              clearBtn.textContent = "Bersihkan semua notifikasi";
            }
          }

          // (opsional) badge jumlah notifikasi di ikon lonceng
          const badge = document.querySelector(".notification-badge");
          if (badge) {
            badge.textContent = saved.length > 0 ? saved.length : "";
          }
        }

        /** Tambahkan notifikasi baru */
        window.addNotification = function (message) {
          const date = new Date();
          const waktu = `${date.getDate()}-${
            date.getMonth() + 1
          }-${date.getFullYear()} ${date
            .getHours()
            .toString()
            .padStart(2, "0")}:${date
            .getMinutes()
            .toString()
            .padStart(2, "0")}`;

          const textContent = `${message} (${waktu})`;

          const saved = JSON.parse(localStorage.getItem("notifikasiApp")) || [];
          saved.unshift({ waktu, text: textContent });

          // batasi maksimal 20 notifikasi
          if (saved.length > 20) saved.pop();

          localStorage.setItem("notifikasiApp", JSON.stringify(saved));
          renderNotifications();

          // tampilkan panel notifikasi sementara
          notifPanel.classList.add("active");
          setTimeout(() => notifPanel.classList.remove("active"), 4000);
        };

        /** Tombol 'Bersihkan semua notifikasi' */
        clearBtn?.addEventListener("click", () => {
          localStorage.removeItem("notifikasiApp");
          renderNotifications();
          setTimeout(() => notifPanel.classList.remove("active"), 1000);
        });

        // === Render notifikasi awal saat halaman dimuat ===
        renderNotifications();
      });
    </script>
  </body>
</html>
